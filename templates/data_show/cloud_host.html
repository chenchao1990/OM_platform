{% extends 'base/base.html' %}
{% block css %}
    <link rel="stylesheet" href="/static/css/colorpicker.css" />
    <link rel="stylesheet" href="/static/css/datepicker.css" />
    <link rel="stylesheet" href="/static/css/uniform.css" />
    <link rel="stylesheet" href="/static/css/select2.css" />
    <link rel="stylesheet" href="/static/css/bootstrap-wysihtml5.css" />

    <style>
        .true-rule{
            color: green;
        }
        .false-rule{
            color: red;
        }
        .error-msg{
            color: red;
            font-weight: bold;
        }

        .table td{
            text-align: center;
        }
        .current-day{
{#            background-color: #ff8001;#}
            color: black;
            font-weight: bold;
        }

    </style>
{% endblock %}


{% block container %}
    <div class="nopadding" style="margin-top: 20px;">

    <table class="table table-striped table-bordered" style="border: 1px solid #CDCDCD;">

          <thead>
              <tr>
                  <th></th>
                  <th></th>
                  <th>云主机数量</th>
              </tr>
            <tr>
              <th>别名</th>
              <th>公司名称</th>
              <th>第一周</th>
              <th>第二周</th>
              <th>第三周</th>
              <th>第四周</th>
            </tr>
          </thead>
{#              <tbody id="rule-list" style="font-weight: bold;text-align:center;">#}
          <tbody id="data-list" class="tbody-font">

          </tbody>
        </table>
    </div>
{% endblock %}


{% block js %}
    <script type="text/javascript">

        $(function(){
{#            $.InitMenu('#asset_list');          /* 控制左侧菜单的闭合 为点击的按钮添加激活的样式 */#}
            Initialise();

        });
        function Initialise () {
            $.ajax({
                url:'/cloud/show_data/',
                type:'POST',
                traditional:true,
                data:{'host_data':'get_all'},
                success: function (callback) {
                    var callbacks = $.parseJSON(callback);               /* 将后台返回的数据 序列化为字典*/
                    console.log("99999999", callbacks);

                    EmbedIntoTable(callbacks,"#data-list");   // 将所有的数据都添加到id=table-body的tbody标签中

                },
                error:function(){
                    $('#error-message').text('请求失败！！')
                }
            });  // end ajax
        }

        function EmbedIntoTable(response, body){
            var response_status = response.status;
            if(response_status){
                $(body).empty();
                $.each(response.data,function(key,value){
                    var another_name = value.another_name;
                    var company = value.company;
                    var host_count = value.host_count;
                    var data_id = value.id;

                    var tds = [];
                    tds.push($.CreateTd({'class':'taskDesc'}, {}, another_name));
                    tds.push($.CreateTd({'class':'taskDesc'}, {}, company));
                    tds.push($.CreateTd({'class':'taskDesc'}, {}, host_count));

                    var tr = $.CreateTr({'data_id':data_id}, {}, tds);

                    $(body).append(tr)
                })
            }else {
                $('#error-message').text(response.message);
            }
        }

        function CurrentTime(current_time, current_month){

            $('#current-time').text(current_time);
            $('#current-month').text(current_month).append("<span class='caret'></span>");

        }
{#        定位到当月当天的位置，并添加颜色样式#}
        function CurrentDay(current_day){
            $('#rule-list').children().each(function () {
                var day_num = $(this).attr('day-num');
                if (current_day == day_num){
                    $(this).children().attr('style', 'background-color: #ff8001');
                    $(this).addClass('current-day')
                }
            })

        }

    </script>

{% endblock %}